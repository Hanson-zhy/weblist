### **一、配置管理接口**
#### 1. 获取系统配置
- **URL**：`GET /api/config`
- **请求参数**：无
- **返回值**：
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "site": {
        "title": "网盘管理系统",
        "description": "个人网盘管理工具",
        "logo": "/static/logo.png",
        "favicon": "/static/favicon.ico"
      },
      "theme": {
        "primary_color": "#1890ff",
        "background_color": "#f5f5f5",
        "text_color": "#333333"
      },
      "layout": {
        "header_html": "<header>...</header>",
        "footer_html": "<footer>...</footer>",
        "custom_css": "/* 自定义CSS */"
      },
      "upload": {
        "max_file_size": 2147483648,
        "allowed_types": ["jpg", "png", "pdf", "zip"]
      }
    }
  }
  ```
- **说明**：返回`config.json`中的完整配置信息，支持热更新（实时读取最新配置）。


#### 2. 更新系统配置
- **URL**：`PUT /api/config`
- **请求参数**（JSON体）：
  ```json
  {
    "site": {
      "title": "新网盘系统",  // 可选，仅更新需要修改的字段
      "description": "新版个人网盘工具"
    },
    "theme": {
      "primary_color": "#ff0000"  // 支持hex（#fff）或rgb（rgb(255,0,0)）格式
    }
  }
  ```
- **返回值**：
  ```json
  {
    "code": 200,
    "message": "配置更新成功",
    "data": {
      "updated_fields": ["site.title", "site.description", "theme.primary_color"]
    }
  }
  ```
- **说明**：
  - 支持部分更新（仅传递需要修改的字段）。
  - 触发主题色值验证（如不合法返回`400`错误）。


### **二、文件管理接口**
#### 1. 文件列表分页查询
- **URL**：`GET /api/list`
- **请求参数**（Query）：
  - `page`：整数，页码（默认1）
  - `page_size`：整数，每页条数（默认20）
  - `keyword`：字符串，文件名搜索关键词（可选）
  - `file_type`：字符串，文件类型筛选（如"pdf"，可选）
- **返回值**：
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "total": 156,  // 总文件数
      "page": 1,
      "page_size": 20,
      "files": [
        {
          "file_id": "f123456",
          "name": "文档.pdf",
          "size": 204800,  // 字节数
          "type": "pdf",
          "upload_time": "2025-08-19T10:30:00Z",
          "download_url": "/api/files/f123456/download"
        },
        // ...更多文件
      ]
    }
  }
  ```
- **说明**：实现分页加载，支持按关键词和类型筛选。

### **三、用户认证接口**
#### 2. 修改密码
- **URL**：`PUT /api/auth/password`
- **请求参数**（JSON体，需携带登录Token）：
  ```json
  {
    "old_password": "123456",
    "new_password": "abc123"  // 后端用bcrypt加密存储
  }
  ```
- **返回值**：
  ```json
  {
    "code": 200,
    "message": "密码修改成功"
  }
  ```


### **四、系统监控接口**
#### 1. 操作日志查询
- **URL**：`GET /api/logs`
- **请求参数**（Query，需携带登录Token）：
  - `page`：整数，页码（默认1）
  - `page_size`：整数，每页条数（默认20）
  - `start_time`：字符串，开始时间（如"2025-08-01"，可选）
  - `end_time`：字符串，结束时间（如"2025-08-19"，可选）
- **返回值**：
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {
      "total": 320,
      "page": 1,
      "page_size": 20,
      "logs": [
        {
          "log_id": "l987654",
          "username": "admin",
          "operation": "upload_file",
          "detail": "上传文件：文档.pdf",
          "operate_time": "2025-08-19T10:30:00Z",
          "ip": "192.168.1.100"
        },
        // ...更多日志
      ]
    }
  }
  ```


### **统一错误响应格式**
所有接口异常时返回以下格式：
```json
{
  "code": 400,  // 错误码（400参数错误、401未授权、403禁止访问、404资源不存在、500服务器错误等）
  "message": "不支持的文件类型：exe",  // 错误描述
  "data": null
}
```


### **接口特性说明**
1. **安全限制**：
   - 所有写操作（更新配置、上传文件、删除文件等）需登录认证（携带JWT Token）。
   - API访问频率限制（如每分钟最多60次请求，超限返回`429 Too Many Requests`）。
2. **缓存机制**：
   - 配置文件缓存（默认5分钟，通过`/api/config`更新后主动刷新缓存）。
   - 文件列表分页结果缓存（默认5分钟，新增/删除文件后主动刷新缓存）。
3. **文档支持**：通过FastAPI自动生成OpenAPI 3.0文档，访问`/docs`即可查看和调试接口。